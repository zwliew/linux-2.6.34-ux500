/*
 * drivers/mfd/ste_conn/ste_cg2900.h
 *
 * Copyright (C) ST-Ericsson SA 2010
 * Authors:
 * Par-Gunnar Hjalmdahl (par-gunnar.p.hjalmdahl@stericsson.com) for ST-Ericsson.
 * Henrik Possung (henrik.possung@stericsson.com) for ST-Ericsson.
 * Josef Kindberg (josef.kindberg@stericsson.com) for ST-Ericsson.
 * Dariusz Szymszak (dariusz.xd.szymczak@stericsson.com) for ST-Ericsson.
 * Kjell Andersson (kjell.k.andersson@stericsson.com) for ST-Ericsson.
 * License terms:  GNU General Public License (GPL), version 2
 *
 * Linux Bluetooth HCI H:4 Driver for ST-Ericsson connectivity controller CG2900.
 */

#ifndef _STE_CG2900_H_
#define _STE_CG2900_H_

#include "bluetooth_defines.h"

/* Supported chips */
#define CG2900_SUPP_MANUFACTURER		0x30
#define CG2900_SUPP_REVISION_MIN		0x0700
#define CG2900_SUPP_REVISION_MAX		0x0700

/* Specific chip version data */
#define CG2900_PG1_REV				0x0700
#define CG2900_PG1_SUB_VER			0x0011

/*
 * 	Bluetooth
 */

/* Bluetooth Vendor Specific Opcode Command Field (OCF) */
#define CG2900_BT_OCF_VS_STORE_IN_FS			0x0022
#define CG2900_BT_OCF_VS_WRITE_FILE_BLOCK		0x002E
#define CG2900_BT_OCF_VS_POWER_SWITCH_OFF		0x0140
#define CG2900_BT_OCF_VS_SYSTEM_RESET			0x0312
#define CG2900_BT_OCF_VS_BLUETOOTH_ENABLE		0x0310
#define CG2900_BT_OCF_VS_READ_REGISTER			0x0104
#define CG2900_BT_OCF_VS_WRITE_REGISTER			0x0103
#define CG2900_BT_OCF_VS_BT_ENABLE_OPCODE		0x0110

#define CG2900_BT_OPCODE_NONE				0xFFFF

/* BT HCI VS command op codes in LSB-MSB format */
#define CG2900_BT_VS_SET_HARDWARE_CONFIGURATION_LSB	0x54
#define CG2900_BT_VS_SET_HARDWARE_CONFIGURATION_MSB	0xFD
#define CG2900_BT_VS_SET_SESSION_CONFIGURATION_LSB	0x55
#define CG2900_BT_VS_SET_SESSION_CONFIGURATION_MSB	0xFD
#define CG2900_BT_VS_SESSION_CONTROL_LSB		0x57
#define CG2900_BT_VS_SESSION_CONTROL_MSB		0xFD
#define CG2900_BT_VS_RESET_SESSION_CONFIGURATION_LSB	0x56
#define CG2900_BT_VS_RESET_SESSION_CONFIGURATION_MSB	0xFD

/* Defines needed for HCI VS Store In FS cmd creation. */
#define CG2900_VS_STORE_IN_FS_USR_ID_POS		HCI_BT_CMD_PARAM_POS
#define CG2900_VS_STORE_IN_FS_USR_ID_SIZE		1
#define CG2900_VS_STORE_IN_FS_PARAM_LEN_POS		(CG2900_VS_STORE_IN_FS_USR_ID_POS + \
							CG2900_VS_STORE_IN_FS_USR_ID_SIZE)
#define CG2900_VS_STORE_IN_FS_PARAM_LEN_SIZE		1
#define CG2900_VS_STORE_IN_FS_PARAM_POS			(CG2900_VS_STORE_IN_FS_PARAM_LEN_POS + \
							CG2900_VS_STORE_IN_FS_PARAM_LEN_SIZE)
#define CG2900_VS_STORE_IN_FS_USR_ID_BD_ADDR		0xFE

/* BT HCI Command parameters */

/* VS_Session_Control SessionControl param */
#define CG2900_BT_SESSION_START				0x00
#define CG2900_BT_SESSION_STOP				0x01
#define CG2900_BT_SESSION_PAUSE				0x02
#define CG2900_BT_SESSION_RESUME			0x03

/* BT command lengths. Header is always first 3 bytes */
#define CG2900_BT_LEN_VS_SET_HARDWARE_CONFIGURATION	10
#define CG2900_BT_LEN_VS_SET_SESSION_CONFIGURATION	37
#define CG2900_BT_LEN_VS_SESSION_CONTROL		5
#define CG2900_BT_LEN_VS_RESET_SESSION_CONFIGURATION	4

/*
 *	FM
 */

/* FM Opcode generic*/
#define CG2900_FM_GEN_OPCODE_LEGACY_API			0xFE

/* FM Opcode offset generic*/
#define CG2900_FM_GEN_OPCODE_OFFSET_CMD			2
#define CG2900_FM_GEN_OPCODE_OFFSET_CMD_CMPL		3
#define CG2900_FM_GEN_OPCODE_OFFSET_INTERRUPT		2

/* FM Opcode offset legacy */
#define CG2900_FM_LEG_STATUS_OFFSET_CMD_CMPL		5
#define CG2900_FM_LEG_FUNC_OFFSET_CMD_CMPL		6
#define CG2900_FM_LEG_HDR_OFFSET_CMD_CMPL		7

/* FM event*/
#define CG2900_FM_EVENT_UNKNOWN				0
#define CG2900_FM_EVENT_CMD_COMPLETE			1
#define CG2900_FM_EVENT_INTERRUPT			2

/* FM do-command identifiers. */
#define CG2900_FM_DO_AIP_FADE_START			0x0046
#define CG2900_FM_DO_AUP_BT_FADE_START			0x01C2
#define CG2900_FM_DO_AUP_EXT_FADE_START			0x0102
#define CG2900_FM_DO_AUP_FADE_START			0x00A2
#define CG2900_FM_DO_FMR_SETANTENNA			0x0663
#define CG2900_FM_DO_FMR_SP_AFSWITCH_START		0x04A3
#define CG2900_FM_DO_FMR_SP_AFUPDATE_START		0x0463
#define CG2900_FM_DO_FMR_SP_BLOCKSCAN_START		0x0683
#define CG2900_FM_DO_FMR_SP_PRESETPI_START		0x0443
#define CG2900_FM_DO_FMR_SP_SCAN_START			0x0403
#define CG2900_FM_DO_FMR_SP_SEARCH_START		0x03E3
#define CG2900_FM_DO_FMR_SP_SEARCHPI_START		0x0703
#define CG2900_FM_DO_FMR_SP_TUNE_SETCHANNEL		0x03C3
#define CG2900_FM_DO_FMR_SP_TUNE_STEPCHANNEL		0x04C3
#define CG2900_FM_DO_FMT_PA_SETCONTROL 			0x01A4
#define CG2900_FM_DO_FMT_PA_SETMODE 			0x01E4
#define CG2900_FM_DO_FMT_SP_TUNE_SETCHANNEL		0x0064
#define CG2900_FM_DO_GEN_ANTENNACHECK_START		0x02A1
#define CG2900_FM_DO_GEN_GOTOMODE			0x0041
#define CG2900_FM_DO_GEN_POWERSUPPLY_SETMODE 		0x0221
#define CG2900_FM_DO_GEN_SELECTREFERENCECLOCK		0x0201
#define CG2900_FM_DO_GEN_SETPROCESSINGCLOCK 		0x0241
#define CG2900_FM_DO_GEN_SETREFERENCECLOCKPLL 		0x01A1
#define CG2900_FM_DO_TST_TX_RAMP_START 			0x0147
#define CG2900_FM_CMD_NONE				0xFFFF
#define CG2900_FM_CMD_ID_GEN_GOTO_POWER_DOWN		0x0081
#define CG2900_FM_CMD_ID_GEN_GOTO_STANDBY		0x0061

/* FM Command IDs */
#define CG2900_FM_CMD_ID_AUP_EXT_SET_MODE		0x0162
#define CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL		0x0182
#define CG2900_FM_CMD_ID_AIP_SET_MODE			0x01C6
#define CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL		0x01A6
#define CG2900_FM_CMD_ID_AIP_BT_SET_MODE		0x01E6

/* FM Command Parameters. */
#define CG2900_FM_CMD_PARAMETERS_ENABLE			0x00
#define CG2900_FM_CMD_PARAMETERS_DISABLE		0x01
#define CG2900_FM_CMD_PARAMETERS_RESET			0x02
#define CG2900_FM_CMD_PARAMETERS_WRITECOMMAND		0x10
#define CG2900_FM_CMD_PARAMETERS_SET_INT_MASK_ALL	0x20
#define CG2900_FM_CMD_PARAMETERS_GET_INT_MASK_ALL	0x21
#define CG2900_FM_CMD_PARAMETERS_SET_INT_MASK		0x22
#define CG2900_FM_CMD_PARAMETERS_GET_INT_MASK		0x23
#define CG2900_FM_CMD_PARAMETERS_FM_FW_DOWNLOAD		0x30
#define CG2900_FM_CMD_PARAMETERS_NONE			0xFF

/* FM Legacy Command Parameters */
#define CG2900_FM_CMD_LEG_PARAMETERS_WRITE		0x00
#define CG2900_FM_CMD_LEG_PARAMETERS_READ		0x01

/* FM Command Status. */
#define CG2900_FM_CMD_STATUS_COMMAND_SUCCEEDED		0x00
#define CG2900_FM_CMD_STATUS_HW_FAILURE			0x03
#define CG2900_FM_CMD_STATUS_INVALID_PARAMS		0x12
#define CG2900_FM_CMD_STATUS_UNINITILIZED		0x15
#define CG2900_FM_CMD_STATUS_UNSPECIFIED_ERROR		0x1F
#define CG2900_FM_CMD_STATUS_COMMAND_DISALLOWED		0x0C
#define CG2900_FM_CMD_STATUS_FW_WRONG_SEQUENCE_NR	0xF1
#define CG2900_FM_CMD_STATUS_FW_UNKNOWN_FILE		0xF2
#define CG2900_FM_CMD_STATUS_FW_FILE_VER_MISMATCH	0xF3

/* FM Interrupts. */
#define CG2900_FM_IRPT_FIQ				0x0000
#define CG2900_FM_IRPT_OPERATION_SUCCEEDED		0x0001
#define CG2900_FM_IRPT_OPERATION_FAILED			0x0002
#define CG2900_FM_IRPT_BUFFER_FULL			0x0008
#define CG2900_FM_IRPT_BUFFER_EMPTY			0x0008
#define CG2900_FM_IRPT_SIGNAL_QUALITY_LOW		0x0010
#define CG2900_FM_IRPT_MUTE_STATUS_CHANGED		0x0010
#define CG2900_FM_IRPT_MONO_STEREO_TRANSITION		0x0020
#define CG2900_FM_IRPT_OVER_MODULATION			0x0020
#define CG2900_FM_IRPT_RDS_SYNC_FOUND			0x0040
#define CG2900_FM_IRPT_INPUT_OVERDRIVE			0x0040
#define CG2900_FM_IRPT_RDS_SYNC_LOST			0x0080
#define CG2900_FM_IRPT_PI_CODE_CHANGED			0x0100
#define CG2900_FM_IRPT_REQUEST_BLOCK_AVALIBLE		0x0200
#define CG2900_FM_IRPT_BUFFER_CLEARED			0x2000
#define CG2900_FM_IRPT_WARM_BOOT_READY			0x4000
#define CG2900_FM_IRPT_COLD_BOOT_READY			0x8000

/* FM Legacy Function Command Parameters */

/* AUP_EXT_SetMode Output enum */
#define CG2900_FM_CMD_AUP_EXT_SET_MODE_DISABLED		0x0000
#define CG2900_FM_CMD_AUP_EXT_SET_MODE_I2S		0x0001
#define CG2900_FM_CMD_AUP_EXT_SET_MODE_PARALLELL	0x0002

/* SetControl Conversion enum */
#define CG2900_FM_CMD_SET_CONTROL_CONVERSION_UP		0x0000
#define CG2900_FM_CMD_SET_CONTROL_CONVERSION_DOWN	0x0001

/* AIP_SetMode Input enum */
#define CG2900_FM_CMD_AIP_SET_MODE_INPUT_ANALOG		0x0000
#define CG2900_FM_CMD_AIP_SET_MODE_INPUT_DIGITAL	0x0001

/* AIP_BT_SetMode Input enum */
#define CG2900_FM_CMD_AIP_BT_SET_MODE_INPUT_RESERVED	0x0000
#define CG2900_FM_CMD_AIP_BT_SET_MODE_INPUT_I2S		0x0001
#define CG2900_FM_CMD_AIP_BT_SET_MODE_INPUT_PARALLEL	0x0002
#define CG2900_FM_CMD_AIP_BT_SET_MODE_INPUT_FIFO	0x0003

/* FM Lengths */
#define CG2900_FM_CMD_LEN_AUP_EXT_SET_MODE		8
#define CG2900_FM_CMD_LEN_AUP_EXT_SET_CONTROL		8
#define CG2900_FM_CMD_LEN_AIP_SET_MODE			8
#define CG2900_FM_CMD_LEN_AIP_BT_SET_CONTROL		8
#define CG2900_FM_CMD_LEN_AIP_BT_SET_MODE		8

/* Following defines should be used by users of STE_CONN, i.e. having no H:4 header */
#define CG2900_FM_USER_GEN_OPCODE_OFFSET_CMD_CMPL	(CG2900_FM_GEN_OPCODE_OFFSET_CMD_CMPL - HCI_H4_SIZE)
#define CG2900_FM_USER_LEG_STATUS_OFFSET_CMD_CMPL	(CG2900_FM_LEG_STATUS_OFFSET_CMD_CMPL - HCI_H4_SIZE)
#define CG2900_FM_USER_LEG_FUNC_OFFSET_CMD_CMPL		(CG2900_FM_LEG_FUNC_OFFSET_CMD_CMPL - HCI_H4_SIZE)
#define CG2900_FM_USER_LEG_HDR_OFFSET_CMD_CMPL		(CG2900_FM_LEG_HDR_OFFSET_CMD_CMPL - HCI_H4_SIZE)

/* FM Command ID mapped per byte and shifted 3 bits left
 * Also adds number of parameters at first 3 bits of LSB.
 */
#define CG2900_SET_FM_CMD_ID_LSB(__u16_id, __nbr_of_data)	((uint8_t)(((__u16_id << 3) & 0x00FF) | __nbr_of_data))
#define CG2900_SET_FM_CMD_ID_MSB(__u16_id)		((uint8_t)(__u16_id >> 5))

#define CG2900_FM_CMD_ID_AUP_EXT_SET_MODE_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AUP_EXT_SET_MODE, 1)
#define CG2900_FM_CMD_ID_AUP_EXT_SET_MODE_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AUP_EXT_SET_MODE)
#define CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL_LSB	CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL, 1)
#define CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL_MSB	CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL)
#define CG2900_FM_CMD_ID_AIP_SET_MODE_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AIP_SET_MODE, 1)
#define CG2900_FM_CMD_ID_AIP_SET_MODE_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AIP_SET_MODE)
#define CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL, 1)
#define CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL)
#define CG2900_FM_CMD_ID_AIP_BT_SET_MODE_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AIP_BT_SET_MODE, 1)
#define CG2900_FM_CMD_ID_AIP_BT_SET_MODE_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AIP_BT_SET_MODE)

/* FM Response IDs. Same construction as FM Command IDs */
#define CG2900_FM_RSP_ID_AUP_EXT_SET_MODE_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AUP_EXT_SET_MODE, 0)
#define CG2900_FM_RSP_ID_AUP_EXT_SET_MODE_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AUP_EXT_SET_MODE)
#define CG2900_FM_RSP_ID_AUP_EXT_SET_CONTROL_LSB	CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL, 0)
#define CG2900_FM_RSP_ID_AUP_EXT_SET_CONTROL_MSB	CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AUP_EXT_SET_CONTROL)
#define CG2900_FM_RSP_ID_AIP_SET_MODE_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AIP_SET_MODE, 0)
#define CG2900_FM_RSP_ID_AIP_SET_MODE_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AIP_SET_MODE)
#define CG2900_FM_RSP_ID_AIP_BT_SET_CONTROL_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL, 0)
#define CG2900_FM_RSP_ID_AIP_BT_SET_CONTROL_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AIP_BT_SET_CONTROL)
#define CG2900_FM_RSP_ID_AIP_BT_SET_MODE_LSB		CG2900_SET_FM_CMD_ID_LSB(CG2900_FM_CMD_ID_AIP_BT_SET_MODE, 0)
#define CG2900_FM_RSP_ID_AIP_BT_SET_MODE_MSB		CG2900_SET_FM_CMD_ID_MSB(CG2900_FM_CMD_ID_AIP_BT_SET_MODE)

#endif /* _STE_CG2900_H_ */
